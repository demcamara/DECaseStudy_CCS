CDW_SAPP_BRANCH

***************HIVE TABLE*********************************************************************************


DROP TABLE IF EXISTS CDW_SAPP_BRANCH;
DROP TABLE IF EXISTS STAGING_CDW_SAPP_BRANCH;
DROP TABLE IF EXISTS CDW_SAPPBRANCH;


CREATE EXTERNAL TABLE STAGING_CDW_SAPP_BRANCH
(BRANCH_CODE INT,
 BRANCH_NAME VARCHAR (25),
 BRANCH_STREET VARCHAR(30),
 BRANCH_CITY VARCHAR(30),
 BRANCH_STATE VARCHAR(30),
 BRANCH_ZIP INT,
 BRANCH_PHONE VARCHAR(13),
 LAST_UPDATED TIMESTAMP)

ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n'
LOCATION "/user/DECaseStudy/Credit_Card_System/CDW_SAPP_BRANCH";



SET hive.exec.dynamic.partition = true; 
SET hive.exec.dynamic.partition.mode = nonstrict;

CREATE EXTERNAL TABLE CDW_SAPPBRANCH
(BRANCH_CODE INT,
 BRANCH_NAME VARCHAR (25),
 BRANCH_STREET VARCHAR(30),
 BRANCH_CITY VARCHAR(30),
 BRANCH_ZIP INT,
 BRANCH_PHONE VARCHAR(13),
 LAST_UPDATED TIMESTAMP)
PARTITIONED BY (BRANCH_STATE VARCHAR(30))

ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' 
LINES TERMINATED BY '\n' 
LOCATION "/user/DECaseStudy/Credit_Card_System/OozieWorks/CDW_SAPP_BRANCH";



SET hive.exec.dynamic.partition = true; 
SET hive.exec.dynamic.partition.mode = nonstrict;

INSERT OVERWRITE TABLE CDW_SAPPBRANCH
PARTITION(BRANCH_STATE) 
select  
BRANCH_CODE,
BRANCH_NAME,
BRANCH_STREET, 
BRANCH_CITY, 
BRANCH_ZIP,
BRANCH_PHONE,
LAST_UPDATED,
BRANCH_STATE FROM STAGING_CDW_SAPP_BRANCH;
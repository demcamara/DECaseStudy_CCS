CDW_SAPP_TIME

*****************HIVE TABLE***********************************************
DROP TABLE IF EXISTS CDW_SAPPTIME;
DROP TABLE IF EXISTS STAGING_CDW_SAPPTIME;

CREATE EXTERNAL TABLE STAGING_CDW_SAPP_TIME
(TIMEID VARCHAR(8),
 DAY INT,
 MONTH INT,
 QUARTER VARCHAR(8),
 YEAR INT)

ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' 
LINES TERMINATED BY '\n' 
LOCATION "/user/DECaseStudy/Credit_Card_System/STAGING_CDW_SAPP_TIME";



SET hive.exec.dynamic.partition = true; 
SET hive.exec.dynamic.partition.mode = nonstrict;

CREATE EXTERNAL TABLE CDW_SAPPTIME
(TIMEID VARCHAR(8),
 DAY INT,
 MONTH INT,
 YEAR INT)
PARTITIONED BY (QUARTER VARCHAR(8))

ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n' 
STORED AS TEXTFILE 
LOCATION "/user/DECaseStudy/Credit_Card_System/CDW_SAPPTIME";



SET hive.exec.dynamic.partition = true; 
SET hive.exec.dynamic.partition.mode = nonstrict;

INSERT OVERWRITE TABLE CDW_SAPPTIME
PARTITION(QUARTER) 
select  
TIMEID,
DAY,
MONTH,
YEAR, 
QUARTER FROM STAGING_CDW_SAPP_TIME;
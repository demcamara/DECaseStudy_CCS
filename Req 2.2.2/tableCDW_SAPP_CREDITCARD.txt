CDW_SAPP_CREDITCARD

*******************HIVE TABLE************************************************

DROP TABLE IF EXISTS CDW_SAPP_CREDITCARD;
DROP TABLE IF EXISTS CDW_SAPPCREDITCARD;
DROP TABLE IF EXISTS STAGING_CDW_SAPP_CREDITCARD;


CREATE EXTERNAL TABLE STAGING_CDW_SAPP_CREDITCARD
(CUST_CC_NO STRING,
 TIMEID VARCHAR(8),
 CUST_SSN INT,
 BRANCH_CODE INT,
 TRANSACTION_TYPE VARCHAR(30),
 TRANSACTION_VALUE DECIMAL(20,3))

ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n'
LOCATION "/user/DECaseStudy/Credit_Card_System/STAGING_CDW_SAPP_CREDITCARD";


SET hive.exec.dynamic.partition = true; 
SET hive.exec.dynamic.partition.mode = nonstrict;

CREATE EXTERNAL TABLE CDW_SAPPCREDITCARD
(CUST_CC_NO STRING,
 TIMEID VARCHAR(8),
 CUST_SSN INT,
 BRANCH_CODE INT,
 TRANSACTION_VALUE DECIMAL(20,3))
PARTITIONED BY (TRANSACTION_TYPE VARCHAR(30))

ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' 
LINES TERMINATED BY '\n' 
LOCATION "/user/DECaseStudy/Credit_Card_System/CDW_SAPPCREDITCARD";


SET hive.exec.dynamic.partition = true; 
SET hive.exec.dynamic.partition.mode = nonstrict;

INSERT OVERWRITE TABLE CDW_SAPPCREDITCARD
PARTITION(TRANSACTION_TYPE) 
select  
CUST_CC_NO,
TIMEID,
CUST_SSN,
BRANCH_CODE, 
TRANSACTION_VALUE, 
TRANSACTION_TYPE FROM STAGING_CDW_SAPP_CREDITCARD;

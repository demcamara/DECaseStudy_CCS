CDW_SAPP_CUSTOMER

******************HIVE TABLE*************************************************
DROP TABLE IF EXISTS CDW_SAPP_CUSTOMER;
DROP TABLE IF EXISTS STAGING_CDW_SAPPCUSTOMER;
DROP TABLE IF EXISTS CDW_SAPPCUSTOMER;

CREATE EXTERNAL TABLE STAGING_CDW_SAPPCUSTOMER
(CUST_SSN INT,
 CUST_F_NAME VARCHAR(40),
 CUST_M_NAME VARCHAR(40),
 CUST_L_NAME VARCHAR(40),
 CUST_CC_NO STRING,
 CUST_STREET VARCHAR(38),
 CUST_CITY VARCHAR(40),
 CUST_STATE VARCHAR(13),
 CUST_COUNTRY VARCHAR(30),
 CUST_ZIP INT,
 CUST_PHONE VARCHAR(28),
 CUST_EMAIL VARCHAR(40),
 LAST_UPDATED TIMESTAMP)


ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' 
LINES TERMINATED BY '\n' 
LOCATION "/user/DECaseStudy/Credit_Card_System/CDW_SAPP_CUSTOMER";


SET hive.exec.dynamic.partition = true; 
SET hive.exec.dynamic.partition.mode = nonstrict;

CREATE EXTERNAL TABLE CDW_SAPPCUSTOMER
(CUST_SSN INT,
 CUST_F_NAME VARCHAR(40),
 CUST_M_NAME VARCHAR(40),
 CUST_L_NAME VARCHAR(40),
 CUST_CC_NO STRING,
 CUST_STREET VARCHAR(38),
 CUST_CITY VARCHAR(40),
 CUST_COUNTRY VARCHAR(30),
 CUST_ZIP INT,
 CUST_PHONE VARCHAR(28),
 CUST_EMAIL VARCHAR(40),
 LAST_UPDATED TIMESTAMP)
PARTITIONED BY (CUST_STATE VARCHAR(13))

ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' 
LINES TERMINATED BY '\n' 
LOCATION "/user/DECaseStudy/Credit_Card_System/CDW_SAPPCUSTOMER";

SET hive.exec.dynamic.partition = true; 
SET hive.exec.dynamic.partition.mode = nonstrict;

INSERT OVERWRITE TABLE CDW_SAPPCUSTOMER
PARTITION(CUST_STATE) 
select 
CUST_SSN,
CUST_F_NAME,
CUST_M_NAME,
CUST_L_NAME,
CUST_CC_NO,
CUST_STREET,
CUST_CITY,
CUST_COUNTRY, 
CUST_ZIP,
CUST_PHONE,
CUST_EMAIL,
LAST_UPDATED,
CUST_STATE FROM STAGING_CDW_SAPPCUSTOMER;